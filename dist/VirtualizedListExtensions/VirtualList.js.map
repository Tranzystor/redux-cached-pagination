{"version":3,"sources":["../../src/pagination-lib/VirtualizedListExtensions/VirtualList.js"],"names":["AutoSizerContainer","div","VirtualListWithoutOutline","mapStateToProps","state","props","totalElements","paginator","selectors","getTotalElements","notZeroRowCount","paginationParams","getPaginationParams","searchParams","getSearchParams","mapDispatchToProps","dispatch","updatePaginationParams","VirtualList","isRowLoaded","bind","noRowsRenderer","loadMoreRows","rowRenderer","onRowClick","scrollToIndex","prevSearchParamsKey","startIndex","stopIndex","index","selectedIndex","force","key","style","nextProps","setState","searchParamsKey","scrollToIndexZeroBased","width","height","onRowsRendered","registerChild","rowHeight","propTypes","func","isRequired","number","object"],"mappings":"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","file":"VirtualList.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { List, InfiniteLoader, AutoSizer } from 'react-virtualized';\r\nimport { connect } from 'react-redux';\r\nimport PropTypes from 'prop-types';\r\nimport { bindActionCreators } from 'redux';\r\nimport { buildUniqueKey } from './../utils';\r\nimport styled from 'styled-components';\r\n\r\nconst AutoSizerContainer = styled.div`\r\n    flex: 1 1 auto;\r\n`;\r\n\r\nconst VirtualListWithoutOutline = styled(List)`\r\n    outline: none;\r\n`;\r\n\r\nconst mapStateToProps = (state, props) => {\r\n    const totalElements = props.paginator.selectors.getTotalElements(state);\r\n    const notZeroRowCount = totalElements > 0 ? totalElements : 1;\r\n    return {\r\n        paginationParams: props.paginator.selectors.getPaginationParams(state),\r\n        searchParams: props.paginator.selectors.getSearchParams(state),\r\n        notZeroRowCount\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch, props) => {\r\n    return bindActionCreators({\r\n        updatePaginationParams: props.paginator.updatePaginationParams\r\n    }, dispatch);\r\n}\r\n\r\nclass VirtualList extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.isRowLoaded = this.isRowLoaded.bind(this);\r\n        this.noRowsRenderer = this.noRowsRenderer.bind(this);\r\n        this.loadMoreRows = this.loadMoreRows.bind(this);\r\n        this.rowRenderer = this.rowRenderer.bind(this);\r\n        this.onRowClick = this.onRowClick.bind(this);\r\n        this.state = { scrollToIndex: 0 }\r\n        this.prevSearchParamsKey = buildUniqueKey(props.searchParams);\r\n    }\r\n\r\n    loadMoreRows({ startIndex, stopIndex }) {\r\n        //nop\r\n    }\r\n\r\n    isRowLoaded({ index }) {\r\n        return false;\r\n    }\r\n\r\n    noRowsRenderer() {\r\n        return (<div>no rows</div>);\r\n    }\r\n\r\n    onRowClick(index) {\r\n        this.props.updatePaginationParams({ selectedIndex: index, force: false });\r\n    }\r\n\r\n    rowRenderer({ index, key, style }) {\r\n        return (\r\n            <div key={key} style={style} onClick={() => { this.onRowClick(index) }}>\r\n                {this.props.rowRenderer(index)}\r\n            </div>);\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        const { selectedIndex, force } = nextProps.paginationParams;\r\n        if (force) {\r\n            this.setState({ scrollToIndex: selectedIndex });\r\n        }\r\n\r\n        const searchParamsKey = buildUniqueKey(nextProps.searchParams);\r\n        if (searchParamsKey !== this.prevSearchParamsKey) {\r\n            this.props.updatePaginationParams({ selectedIndex: null, force: true });\r\n            this.prevSearchParamsKey = searchParamsKey;\r\n        }\r\n    }\r\n\r\n    componentWillMount() {\r\n        this.setState({ scrollToIndex: this.props.paginationParams.selectedIndex });\r\n    }\r\n\r\n    render() {\r\n        const scrollToIndexZeroBased = this.state.scrollToIndex;\r\n        return (\r\n            <AutoSizerContainer>\r\n                <AutoSizer>\r\n                    {({ width, height }) => (\r\n                        <InfiniteLoader\r\n                            key={buildUniqueKey(this.props.searchParams)}\r\n                            isRowLoaded={this.isRowLoaded}\r\n                            loadMoreRows={this.loadMoreRows}\r\n                            rowCount={this.props.notZeroRowCount}>\r\n                            {({ onRowsRendered, registerChild }) => {\r\n                                return (\r\n                                    <VirtualListWithoutOutline\r\n                                        ref={registerChild}\r\n                                        height={height}\r\n                                        width={width}\r\n                                        onRowsRendered={onRowsRendered}\r\n                                        rowCount={this.props.notZeroRowCount}\r\n                                        rowRenderer={this.rowRenderer}\r\n                                        noRowsRenderer={this.noRowsRenderer}\r\n                                        rowHeight={this.props.rowHeight}\r\n                                        scrollToIndex={scrollToIndexZeroBased}\r\n                                        scrollToAlignment=\"center\"\r\n                                    />);\r\n                            }\r\n                            }\r\n                        </InfiniteLoader>\r\n                    )}\r\n                </AutoSizer>\r\n            </AutoSizerContainer>\r\n        );\r\n    }\r\n}\r\n\r\nVirtualList.propTypes = {\r\n    rowRenderer: PropTypes.func.isRequired,\r\n    rowHeight: PropTypes.number.isRequired,\r\n    paginator: PropTypes.object.isRequired\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VirtualList);\r\n"]}